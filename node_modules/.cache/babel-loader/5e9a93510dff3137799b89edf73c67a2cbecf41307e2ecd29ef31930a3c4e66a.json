{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useEffect, useState } from \"react\";\nimport { changeUser } from \"../store\";\nimport { useFetchQuestionsQuery, useFetchSubmissionQuery, useFetchUserQuery, setupSubmission, loadQuestionsData, setUserField } from \"../store\";\nconst loadUser = input => {\n  _s();\n  const [userLogged, setUserLogged] = useState(false);\n  const user = useSelector(state => state.userData);\n  const dispatch = useDispatch();\n  const fetchUser = useFetchUserQuery(input);\n  const fetchSubmission = useFetchSubmissionQuery(user);\n  const fetchQuestions = useFetchQuestionsQuery();\n\n  // Dispatch loaded submission\n  useEffect(() => {\n    if (!fetchSubmission.data || fetchSubmission.isLoading || fetchSubmission.error) return;\n    if (!userLogged) return;\n\n    // When user is created, so is the submission\n    // so we don't need to check for anything\n    console.log(fetchSubmission.data[0]);\n    dispatch(setupSubmission(fetchSubmission.data[0]));\n    console.log('loaded submission to slice');\n    return;\n  }, [fetchSubmission.data]);\n\n  // Filter and dispatch loaded user questions\n  useEffect(() => {\n    if (!fetchQuestions.data) return;\n    if (!userLogged) return;\n    let filteredQuestions = [];\n    fetchQuestions.data.map(question => {\n      console.log(user);\n      user.questionsId.map(id => {\n        if (id == question.id) {\n          filteredQuestions.push(question);\n        }\n      });\n    });\n    dispatch(loadQuestionsData(filteredQuestions));\n    console.log('loaded filtered questions to slice');\n    if (!user.startedExam) {\n      const newDate = new Date();\n      const startTime = `${newDate.getDate()}/${newDate.getMonth() + 1}/${newDate.getFullYear()}-${newDate.getHours()}:${newDate.getMinutes()}:${newDate.getSeconds()}`;\n      dispatch(setUserField({\n        key: \"startedExam\",\n        value: true\n      }));\n      dispatch(setUserField({\n        key: \"examStartTime\",\n        value: startTime\n      }));\n    }\n    return ';';\n  }, [fetchQuestions.data]);\n\n  // Dispatch loaded user data\n  useEffect(() => {\n    if (!fetchUser.data || fetchUser.isLoading || fetchUser.error) return;\n    dispatch(changeUser(fetchUser.data));\n    console.log(`loaded user: ${fetchUser.data[0].id}`);\n    console.log(loginInput);\n    setUserLogged(true);\n    return;\n  }, [fetchUser.data]);\n  return () => [fetchUser.isLoading, fetchUser.error];\n};\n_s(loadUser, \"RrNG/NipdAs692RRd+TW+4TRDZo=\", false, function () {\n  return [useSelector, useDispatch, useFetchUserQuery, useFetchSubmissionQuery, useFetchQuestionsQuery];\n});\nfunction useLoadUser(loginInput) {\n  return () => {\n    loadUser(loginInput);\n  };\n}\nexport default useLoadUser;","map":{"version":3,"names":["useDispatch","useSelector","useEffect","useState","changeUser","useFetchQuestionsQuery","useFetchSubmissionQuery","useFetchUserQuery","setupSubmission","loadQuestionsData","setUserField","loadUser","input","userLogged","setUserLogged","user","state","userData","dispatch","fetchUser","fetchSubmission","fetchQuestions","data","isLoading","error","console","log","filteredQuestions","map","question","questionsId","id","push","startedExam","newDate","Date","startTime","getDate","getMonth","getFullYear","getHours","getMinutes","getSeconds","key","value","loginInput","useLoadUser"],"sources":["/Users/machadogomes/Documents/InterviewHub/question_hub/src/Hooks/useLoadUser.js"],"sourcesContent":["import { useDispatch, useSelector } from \"react-redux\";\nimport { useEffect, useState } from \"react\";\nimport { changeUser } from \"../store\";\nimport { \n    useFetchQuestionsQuery, \n    useFetchSubmissionQuery,\n    useFetchUserQuery,\n    setupSubmission,\n    loadQuestionsData,\n    setUserField\n} from \"../store\";\n\nconst loadUser = (input) =>\n{\n    const [userLogged, setUserLogged] = useState(false);\n\n    const user = useSelector(state=>state.userData);\n    const dispatch = useDispatch();\n    const fetchUser = useFetchUserQuery(input);\n    const fetchSubmission = useFetchSubmissionQuery(user);\n    const fetchQuestions = useFetchQuestionsQuery();\n\n    // Dispatch loaded submission\n    useEffect(()=>{\n        if(!fetchSubmission.data || \n            fetchSubmission.isLoading || \n            fetchSubmission.error) return;\n        if(!userLogged) return;\n        \n        // When user is created, so is the submission\n        // so we don't need to check for anything\n        console.log(fetchSubmission.data[0]);\n        dispatch(setupSubmission(fetchSubmission.data[0]));\n        console.log('loaded submission to slice');\n\n        return;\n    }, [fetchSubmission.data]);\n\n    // Filter and dispatch loaded user questions\n    useEffect(() => {\n        if(!fetchQuestions.data)return;\n        if(!userLogged) return;\n        \n        let filteredQuestions = [];\n        fetchQuestions.data.map((question) =>\n        {\n            console.log(user);\n            user.questionsId.map((id) => {\n                if(id == question.id) \n                {\n                    filteredQuestions.push(question);\n                }\n            });\n        })\n\n        dispatch(loadQuestionsData(filteredQuestions));\n        console.log('loaded filtered questions to slice');\n        \n        if(!user.startedExam)\n        {\n            const newDate = new Date();\n            const startTime = `${newDate.getDate()}/${newDate.getMonth()+1}/${newDate.getFullYear()}-${newDate.getHours()}:${newDate.getMinutes()}:${newDate.getSeconds()}`;\n            dispatch(setUserField({key:\"startedExam\", value: true}));\n            dispatch(setUserField({key:\"examStartTime\", value: startTime}));\n        }\n\n        return';'\n    }, [fetchQuestions.data]);    \n\n    // Dispatch loaded user data\n    useEffect(() => {\n        if(!fetchUser.data || fetchUser.isLoading || fetchUser.error) return;\n\n        dispatch(changeUser(fetchUser.data));\n        console.log(`loaded user: ${fetchUser.data[0].id}`);\n        console.log(loginInput);\n\n        setUserLogged(true);\n        return;\n    }, [fetchUser.data]);\n\n    return () => [fetchUser.isLoading, fetchUser.error];\n}\n\nfunction useLoadUser(loginInput)\n{\n    return () => {loadUser(loginInput)}\n}\n\nexport default useLoadUser;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}